(()=>{"use strict";function e(e,n){if(e.length!=n.length)return!1;for(var t=0;t<e.length;t++)if(e[t]!==n[t])return!1;return!0}let n,t,r,i,a,o=60,L="",u=1,l=1,c=1,s=0,M=0,T=0,H=0;function f(){clearTimeout(n),u=1,l=1,c=1,s=0,M=0,T=0,H=0,L="00:00:00.00",document.userData.stopwatch.value=L}function p(){let e=(new Date).getTime()-t.getTime()-1e3*s;e>999&&s++,s>=l*o?(M=0,l++):(M=parseInt(T/100+s),M>=o&&(M-=(l-1)*o)),l>u*o?(c=1,u++):(c=parseInt(T/100+l),c>=o&&(c-=(u-1)*o)),T=Math.round(e/10),T>99&&(T=0),0==T&&(T="00"),T>0&&T<=9&&(T="0"+T),M>0?(a=M,M<10&&(a="0"+M)):a="00",i=c-1,i>0?i<10&&(i="0"+i):i="00",r=u-1,r>0?r<10&&(r="0"+r):r="00",L=r+":"+i+":"+a+"."+T,document.userData.stopwatch.value=L,n=setTimeout((()=>p()),1)}function d(){0==H?(f(),t=new Date,p(),H=1):(clearTimeout(n),H=0)}let v,m,h,y,I,g,E,D,w=document.querySelector("#start-game"),k=document.querySelector("#player-name"),b=document.querySelector(".grid"),C=document.querySelector(".score"),q=document.querySelector(".status"),S=document.querySelector("#results-template"),x=document.querySelector(".results"),A=[];function X(){k.checkValidity()?(document.userData.stopwatch.value="00:00:00.00",v=0,C.innerHTML=0,function(){q.innerHTML=null,b.innerHTML=null,b.style="opacity: 1",A.splice(0,25);for(let e=0;e<25;e++){let e=document.createElement("div");e.innerHTML=0,b.appendChild(e),A.push(e)}N(),N(),b.addEventListener("mousedown",U),document.addEventListener("keydown",F),b.addEventListener("touchstart",Z),b.addEventListener("touchend",$),b.addEventListener("mouseup",W)}(),f(),t=new Date,p(),H=1):alert("Введите имя!")}function Y(){for(let e=0;e<25;e++)A[e].removeAttribute("class"),"0"!==A[e].textContent&&A[e].classList.add("x"+A[e].textContent)}function N(){let e=Math.floor(Math.random()*A.length);0==A[e].innerHTML?A[e].innerHTML=Math.random()>=.9?4:2:N(),Y()}function V(){for(let n=0;n<25;n++)if(n%5==0){let t=A[n].innerHTML,r=A[n+1].innerHTML,i=A[n+2].innerHTML,a=A[n+3].innerHTML,o=A[n+4].innerHTML,L=[parseInt(t),parseInt(r),parseInt(i),parseInt(a),parseInt(o)],u=L.filter((e=>e)),l=5-u.length,c=Array(l).fill(0).concat(u);e(L,c)||(m=!0,A[n].innerHTML=c[0],A[n+1].innerHTML=c[1],A[n+2].innerHTML=c[2],A[n+3].innerHTML=c[3],A[n+4].innerHTML=c[4])}}function j(){for(let n=0;n<25;n++)if(n%5==0){let t=A[n].innerHTML,r=A[n+1].innerHTML,i=A[n+2].innerHTML,a=A[n+3].innerHTML,o=A[n+4].innerHTML,L=[parseInt(t),parseInt(r),parseInt(i),parseInt(a),parseInt(o)],u=L.filter((e=>e)),l=5-u.length,c=Array(l).fill(0),s=u.concat(c);e(L,s)||(m=!0,A[n].innerHTML=s[0],A[n+1].innerHTML=s[1],A[n+2].innerHTML=s[2],A[n+3].innerHTML=s[3],A[n+4].innerHTML=s[4])}}function z(){for(let n=0;n<5;n++){let t=A[n].innerHTML,r=A[n+5].innerHTML,i=A[n+10].innerHTML,a=A[n+15].innerHTML,o=A[n+20].innerHTML,L=[parseInt(t),parseInt(r),parseInt(i),parseInt(a),parseInt(o)],u=L.filter((e=>e)),l=5-u.length,c=Array(l).fill(0).concat(u);e(L,c)||(m=!0,A[n].innerHTML=c[0],A[n+5].innerHTML=c[1],A[n+10].innerHTML=c[2],A[n+15].innerHTML=c[3],A[n+20].innerHTML=c[4])}}function B(){for(let n=0;n<5;n++){let t=A[n].innerHTML,r=A[n+5].innerHTML,i=A[n+10].innerHTML,a=A[n+15].innerHTML,o=A[n+20].innerHTML,L=[parseInt(t),parseInt(r),parseInt(i),parseInt(a),parseInt(o)],u=L.filter((e=>e)),l=5-u.length,c=Array(l).fill(0),s=u.concat(c);e(L,s)||(m=!0,A[n].innerHTML=s[0],A[n+5].innerHTML=s[1],A[n+10].innerHTML=s[2],A[n+15].innerHTML=s[3],A[n+20].innerHTML=s[4])}}function F(e){39===e.keyCode?(e.preventDefault(),O()):37===e.keyCode?(e.preventDefault(),P()):38===e.keyCode?(e.preventDefault(),R()):40===e.keyCode&&(e.preventDefault(),Q())}function G(){let e=S.content.cloneNode(!0),n=e.querySelector(".player"),t=e.querySelector(".time");n.textContent=k.value,t.textContent=document.userData.stopwatch.value,x.appendChild(e)}function J(){for(let e=0;e<A.length;e++)2048==A[e].innerHTML&&(d(),G(),q.innerHTML="Ты выиграл!",k.value="",b.style="opacity: 0.5",w.addEventListener("click",X),b.removeEventListener("mousedown",U),document.removeEventListener("keyup",F),b.removeEventListener("touchstart",Z),b.removeEventListener("touchend",$),b.removeEventListener("mouseup",W))}function K(){let e=0;for(let n=0;n<A.length;n++)0==A[n].innerHTML&&e++;for(let n=0;n<A.length-1;n++)A[n].innerHTML===A[n+1].innerHTML&&e++;for(let n=0;n<20;n++)A[n].innerHTML===A[n+5].innerHTML&&e++;0===e&&(d(),q.innerHTML="Ты проиграл!",b.style="opacity: 0.5",w.addEventListener("click",X),document.removeEventListener("keyup",F),b.removeEventListener("mousedown",U),document.removeEventListener("keyup",F),b.removeEventListener("touchstart",Z),b.removeEventListener("touchend",$),b.removeEventListener("mouseup",W))}function O(){m=!1,V(),function(){for(let e=24;e>0;e--)if(A[e].innerHTML===A[e-1].innerHTML&&0!=A[e].innerHTML&&0!=A[e-1].innerHTML){let n=parseInt(A[e].innerHTML)+parseInt(A[e-1].innerHTML);A[e].innerHTML=n,A[e-1].innerHTML=0,v+=n,C.innerHTML=v,m=!0}J()}(),m&&N(),V(),Y(),K()}function P(){m=!1,j(),function(){for(let e=0;e<24;e++)if(A[e].innerHTML===A[e+1].innerHTML&&0!=A[e].innerHTML&&0!=A[e+1].innerHTML){let n=parseInt(A[e].innerHTML)+parseInt(A[e+1].innerHTML);A[e].innerHTML=n,A[e+1].innerHTML=0,v+=n,C.innerHTML=v,m=!0}J()}(),m&&N(),j(),Y(),K()}function Q(){m=!1,z(),function(){for(let e=24;e>4;e--)if(A[e].innerHTML===A[e-5].innerHTML&&0!=A[e].innerHTML&&0!=A[e-5].innerHTML){let n=parseInt(A[e].innerHTML)+parseInt(A[e-5].innerHTML);A[e].innerHTML=n,A[e-5].innerHTML=0,v+=n,C.innerHTML=v,m=!0}J()}(),m&&N(),z(),Y(),K()}function R(){m=!1,B(),function(){for(let e=0;e<20;e++)if(A[e].innerHTML===A[e+5].innerHTML&&0!=A[e].innerHTML&&0!=A[e+5].innerHTML){let n=parseInt(A[e].innerHTML)+parseInt(A[e+5].innerHTML);A[e].innerHTML=n,A[e+5].innerHTML=0,v+=n,C.innerHTML=v,m=!0}J()}(),m&&N(),B(),Y(),K()}function U(e){I=e.pageX,g=e.pageY,1==e.which&&b.addEventListener("mousemove",(e=>{e.preventDefault(),h=e.pageX,y=e.pageY}))}function W(e){if(1==e.which){e.preventDefault();let n=h-I,t=y-g,r=Math.abs(n)>Math.abs(t),i=Math.abs(t)>Math.abs(n);n>0&&r?O():n<0&&r?P():t>0&&i?Q():t<0&&i&&R(),h=0,y=0,b.removeEventListener("mousemove",(e=>{e.preventDefault(),h=e.pageX,y=e.pageY}))}}function Z(e){e.cancelable&&(e.preventDefault(),E=e.touches[0].pageX,D=e.touches[0].pageY)}function $(e){if(e.cancelable){e.preventDefault();let n=e.changedTouches[0].pageX,t=e.changedTouches[0].pageY,r=n-E,i=t-D,a=Math.abs(r)>Math.abs(i),o=Math.abs(i)>Math.abs(r);r>0&&a?O():r<0&&a?P():i>0&&o?Q():i<0&&o&&R()}}w.addEventListener("click",X)})();
//# sourceMappingURL=main.bundle.js.map