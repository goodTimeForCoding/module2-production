(()=>{"use strict";const e=(e,n)=>{if(e.length!=n.length)return!1;for(let t=0;t<e.length;t++)if(e[t]!==n[t])return!1;return!0},n=60;let t,r,a,i,o,s="",l=1,c=1,L=1,M=0,T=0,u=0,H=0;const p=()=>{clearTimeout(t),l=1,c=1,L=1,M=0,T=0,u=0,H=0,s="00:00:00.00",document.userData.stopwatch.value=s},d=()=>{let e=(new Date).getTime()-r.getTime()-1e3*M;e>999&&M++,M>=c*n?(T=0,c++):(T=parseInt(u/100+M),T>=n&&(T-=(c-1)*n)),c>l*n?(L=1,l++):(L=parseInt(u/100+c),L>=n&&(L-=(l-1)*n)),u=Math.round(e/10),u>99&&(u=0),0==u&&(u="00"),u>0&&u<=9&&(u="0"+u),T>0?(o=T,T<10&&(o="0"+T)):o="00",i=L-1,i>0?i<10&&(i="0"+i):i="00",a=l-1,a>0?a<10&&(a="0"+a):a="00",s=a+":"+i+":"+o+"."+u,document.userData.stopwatch.value=s,t=setTimeout((()=>d()),1)},h=()=>{0==H?(p(),r=new Date,d(),H=1):(clearTimeout(t),H=0)},m="Right",f="Left",v="Down",y=document.querySelector("#start-game"),g=document.querySelector("#player-name"),I=document.querySelector(".grid"),D=document.querySelector(".score"),w=document.querySelector(".status"),b=document.querySelector("#results-template"),x=document.querySelector(".results");let C,E,k,S,q,X,Y,A,U=[];const z=()=>{I.removeEventListener("mousedown",W),document.removeEventListener("keydown",B),I.removeEventListener("touchstart",_),I.removeEventListener("touchend",ee),I.removeEventListener("mouseup",$)},R=()=>{for(let e=0;e<25;e++)U[e].removeAttribute("class"),"0"!==U[e].textContent&&("2"===U[e].textContent||"4"===U[e].textContent?U[e].classList.add("x2-4"):U[e].classList.add("x8-2048"),U[e].classList.add("x"+U[e].textContent))},N=()=>{const e=Math.floor(Math.random()*U.length);0==U[e].innerHTML?U[e].innerHTML=Math.random()>=.9?4:2:N(),R()},V=n=>{for(let t=0;t<25;t++)if(t%5==0){const r=[parseInt(U[t].innerHTML),parseInt(U[t+1].innerHTML),parseInt(U[t+2].innerHTML),parseInt(U[t+3].innerHTML),parseInt(U[t+4].innerHTML)],a=r.filter((e=>e)),i=5-a.length,o=Array(i).fill(0);let s;switch(n){case"Right":s=o.concat(a);break;case"Left":s=a.concat(o)}e(r,s)||(E=!0,U[t].innerHTML=s[0],U[t+1].innerHTML=s[1],U[t+2].innerHTML=s[2],U[t+3].innerHTML=s[3],U[t+4].innerHTML=s[4])}},j=n=>{for(let t=0;t<5;t++){const r=[parseInt(U[t].innerHTML),parseInt(U[t+5].innerHTML),parseInt(U[t+10].innerHTML),parseInt(U[t+15].innerHTML),parseInt(U[t+20].innerHTML)],a=r.filter((e=>e)),i=5-a.length,o=Array(i).fill(0);let s;switch(n){case"Down":s=o.concat(a);break;case"Up":s=a.concat(o)}e(r,s)||(E=!0,U[t].innerHTML=s[0],U[t+5].innerHTML=s[1],U[t+10].innerHTML=s[2],U[t+15].innerHTML=s[3],U[t+20].innerHTML=s[4])}},B=e=>{39===e.keyCode?(e.preventDefault(),K()):37===e.keyCode?(e.preventDefault(),O()):38===e.keyCode?(e.preventDefault(),Q()):40===e.keyCode&&(e.preventDefault(),P())},F=()=>{const e=b.content.cloneNode(!0),n=e.querySelector(".player"),t=e.querySelector(".time");n.textContent=g.value,t.textContent=document.userData.stopwatch.value,x.appendChild(e)},G=()=>{for(let e=0;e<U.length;e++)2048==U[e].innerHTML&&(h(),F(),w.innerHTML="Ты выиграл!",I.style="opacity: 0.5",z())},J=()=>{let e=0;for(let n=0;n<U.length;n++)0==U[n].innerHTML&&e++;for(let n=0;n<U.length-1;n++)U[n].innerHTML===U[n+1].innerHTML&&e++;for(let n=0;n<20;n++)U[n].innerHTML===U[n+5].innerHTML&&e++;0===e&&(h(),w.innerHTML="Ты проиграл!",I.style="opacity: 0.5",z())},K=()=>{E=!1,V(m),(()=>{for(let e=24;e>0;e--)if(U[e].innerHTML===U[e-1].innerHTML&&0!=U[e].innerHTML&&0!=U[e-1].innerHTML){const n=parseInt(U[e].innerHTML)+parseInt(U[e-1].innerHTML);U[e].innerHTML=n,U[e-1].innerHTML=0,C+=n,D.innerHTML=C,E=!0}G()})(),E&&N(),V(m),R(),J()},O=()=>{E=!1,V(f),(()=>{for(let e=0;e<24;e++)if(U[e].innerHTML===U[e+1].innerHTML&&0!=U[e].innerHTML&&0!=U[e+1].innerHTML){const n=parseInt(U[e].innerHTML)+parseInt(U[e+1].innerHTML);U[e].innerHTML=n,U[e+1].innerHTML=0,C+=n,D.innerHTML=C,E=!0}G()})(),E&&N(),V(f),R(),J()},P=()=>{E=!1,j(v),(()=>{for(let e=24;e>4;e--)if(U[e].innerHTML===U[e-5].innerHTML&&0!=U[e].innerHTML&&0!=U[e-5].innerHTML){const n=parseInt(U[e].innerHTML)+parseInt(U[e-5].innerHTML);U[e].innerHTML=n,U[e-5].innerHTML=0,C+=n,D.innerHTML=C,E=!0}G()})(),E&&N(),j(v),R(),J()},Q=()=>{E=!1,j("Up"),(()=>{for(let e=0;e<20;e++)if(U[e].innerHTML===U[e+5].innerHTML&&0!=U[e].innerHTML&&0!=U[e+5].innerHTML){const n=parseInt(U[e].innerHTML)+parseInt(U[e+5].innerHTML);U[e].innerHTML=n,U[e+5].innerHTML=0,C+=n,D.innerHTML=C,E=!0}G()})(),E&&N(),j("Up"),R(),J()},W=e=>{q=e.pageX,X=e.pageY,1==e.which&&Z()},Z=()=>{I.addEventListener("mousemove",(e=>{e.preventDefault(),k=e.pageX,S=e.pageY}))},$=e=>{if(1==e.which){e.preventDefault();const n=k-q,t=S-X,r=Math.abs(n)>Math.abs(t),a=Math.abs(t)>Math.abs(n);n>0&&r?K():n<0&&r?O():t>0&&a?P():t<0&&a&&Q(),k=0,S=0,I.removeEventListener("mousemove",(e=>{e.preventDefault(),k=e.pageX,S=e.pageY}))}},_=e=>{e.cancelable&&(e.preventDefault(),Y=e.touches[0].pageX,A=e.touches[0].pageY)},ee=e=>{if(e.cancelable){e.preventDefault();const n=e.changedTouches[0].pageX,t=e.changedTouches[0].pageY,r=n-Y,a=t-A,i=Math.abs(r)>Math.abs(a),o=Math.abs(a)>Math.abs(r);r>0&&i?K():r<0&&i?O():a>0&&o?P():a<0&&o&&Q()}};y.addEventListener("click",(()=>{g.checkValidity()?(document.userData.stopwatch.value="00:00:00.00",C=0,D.innerHTML=0,(()=>{w.innerHTML=null,I.innerHTML=null,I.style="opacity: 1",U.splice(0,25);for(let e=0;e<25;e++){const e=document.createElement("div");e.innerHTML=0,I.appendChild(e),U.push(e)}N(),N(),I.addEventListener("mousedown",W),document.addEventListener("keydown",B),I.addEventListener("touchstart",_),I.addEventListener("touchend",ee),I.addEventListener("mouseup",$)})(),p(),r=new Date,d(),H=1,y.textContent="Начать заново"):(e=>{const n=document.createElement("div");n.style.zIndex=100,n.style.position="absolute",n.style.left=0,n.style.top=0,n.style.right=0,n.style.padding="10px 3px",n.style.fontSize="30px",n.style.textAlign="center",n.style.backgroundColor="red",n.textContent="Введите имя!",document.body.append(n),setTimeout((()=>{n.remove()}),3e3)})()}))})();
//# sourceMappingURL=main.bundle.js.map