(()=>{"use strict";const e=(e,n)=>{if(e.length!=n.length)return!1;for(var t=0;t<e.length;t++)if(e[t]!==n[t])return!1;return!0};let n,t,r,i,a,o=60,L="",l=1,s=1,M=1,T=0,H=0,c=0,u=0;const p=()=>{clearTimeout(n),l=1,s=1,M=1,T=0,H=0,c=0,u=0,L="00:00:00.00",document.userData.stopwatch.value=L},d=()=>{let e=(new Date).getTime()-t.getTime()-1e3*T;e>999&&T++,T>=s*o?(H=0,s++):(H=parseInt(c/100+T),H>=o&&(H-=(s-1)*o)),s>l*o?(M=1,l++):(M=parseInt(c/100+s),M>=o&&(M-=(l-1)*o)),c=Math.round(e/10),c>99&&(c=0),0==c&&(c="00"),c>0&&c<=9&&(c="0"+c),H>0?(a=H,H<10&&(a="0"+H)):a="00",i=M-1,i>0?i<10&&(i="0"+i):i="00",r=l-1,r>0?r<10&&(r="0"+r):r="00",L=r+":"+i+":"+a+"."+c,document.userData.stopwatch.value=L,n=setTimeout((()=>d()),1)},v=()=>{0==u?(p(),t=new Date,d(),u=1):(clearTimeout(n),u=0)};let m,h,f,I,y,g,E,D,w=document.querySelector("#start-game"),b=document.querySelector("#player-name"),k=document.querySelector(".grid"),C=document.querySelector(".score"),q=document.querySelector(".status"),S=document.querySelector("#results-template"),x=document.querySelector(".results"),A=[];const X=()=>{b.checkValidity()?(document.userData.stopwatch.value="00:00:00.00",m=0,C.innerHTML=0,Y(),p(),t=new Date,d(),u=1,w.textContent="Начать заново"):alert("Введите имя!")},Y=()=>{q.innerHTML=null,k.innerHTML=null,k.style="opacity: 1",A.splice(0,25);for(let e=0;e<25;e++){let e=document.createElement("div");e.innerHTML=0,k.appendChild(e),A.push(e)}V(),V(),k.addEventListener("mousedown",W),document.addEventListener("keydown",G),k.addEventListener("touchstart",_),k.addEventListener("touchend",ee),k.addEventListener("mouseup",$)},N=()=>{for(let e=0;e<25;e++)A[e].removeAttribute("class"),"0"!==A[e].textContent&&A[e].classList.add("x"+A[e].textContent)},V=()=>{let e=Math.floor(Math.random()*A.length);0==A[e].innerHTML?A[e].innerHTML=Math.random()>=.9?4:2:V(),N()},j=()=>{for(let n=0;n<25;n++)if(n%5==0){let t=A[n].innerHTML,r=A[n+1].innerHTML,i=A[n+2].innerHTML,a=A[n+3].innerHTML,o=A[n+4].innerHTML,L=[parseInt(t),parseInt(r),parseInt(i),parseInt(a),parseInt(o)],l=L.filter((e=>e)),s=5-l.length,M=Array(s).fill(0).concat(l);e(L,M)||(h=!0,A[n].innerHTML=M[0],A[n+1].innerHTML=M[1],A[n+2].innerHTML=M[2],A[n+3].innerHTML=M[3],A[n+4].innerHTML=M[4])}},z=()=>{for(let n=0;n<25;n++)if(n%5==0){let t=A[n].innerHTML,r=A[n+1].innerHTML,i=A[n+2].innerHTML,a=A[n+3].innerHTML,o=A[n+4].innerHTML,L=[parseInt(t),parseInt(r),parseInt(i),parseInt(a),parseInt(o)],l=L.filter((e=>e)),s=5-l.length,M=Array(s).fill(0),T=l.concat(M);e(L,T)||(h=!0,A[n].innerHTML=T[0],A[n+1].innerHTML=T[1],A[n+2].innerHTML=T[2],A[n+3].innerHTML=T[3],A[n+4].innerHTML=T[4])}},B=()=>{for(let n=0;n<5;n++){let t=A[n].innerHTML,r=A[n+5].innerHTML,i=A[n+10].innerHTML,a=A[n+15].innerHTML,o=A[n+20].innerHTML,L=[parseInt(t),parseInt(r),parseInt(i),parseInt(a),parseInt(o)],l=L.filter((e=>e)),s=5-l.length,M=Array(s).fill(0).concat(l);e(L,M)||(h=!0,A[n].innerHTML=M[0],A[n+5].innerHTML=M[1],A[n+10].innerHTML=M[2],A[n+15].innerHTML=M[3],A[n+20].innerHTML=M[4])}},F=()=>{for(let n=0;n<5;n++){let t=A[n].innerHTML,r=A[n+5].innerHTML,i=A[n+10].innerHTML,a=A[n+15].innerHTML,o=A[n+20].innerHTML,L=[parseInt(t),parseInt(r),parseInt(i),parseInt(a),parseInt(o)],l=L.filter((e=>e)),s=5-l.length,M=Array(s).fill(0),T=l.concat(M);e(L,T)||(h=!0,A[n].innerHTML=T[0],A[n+5].innerHTML=T[1],A[n+10].innerHTML=T[2],A[n+15].innerHTML=T[3],A[n+20].innerHTML=T[4])}},G=e=>{39===e.keyCode?(e.preventDefault(),P()):37===e.keyCode?(e.preventDefault(),Q()):38===e.keyCode?(e.preventDefault(),U()):40===e.keyCode&&(e.preventDefault(),R())},J=()=>{let e=S.content.cloneNode(!0),n=e.querySelector(".player"),t=e.querySelector(".time");n.textContent=b.value,t.textContent=document.userData.stopwatch.value,x.appendChild(e)},K=()=>{for(let e=0;e<A.length;e++)2048==A[e].innerHTML&&(v(),J(),q.innerHTML="Ты выиграл!",k.style="opacity: 0.5",w.addEventListener("click",X),k.removeEventListener("mousedown",W),document.removeEventListener("keydown",G),k.removeEventListener("touchstart",_),k.removeEventListener("touchend",ee),k.removeEventListener("mouseup",$))},O=()=>{let e=0;for(let n=0;n<A.length;n++)0==A[n].innerHTML&&e++;for(let n=0;n<A.length-1;n++)A[n].innerHTML===A[n+1].innerHTML&&e++;for(let n=0;n<20;n++)A[n].innerHTML===A[n+5].innerHTML&&e++;0===e&&(v(),q.innerHTML="Ты проиграл!",k.style="opacity: 0.5",w.addEventListener("click",X),k.removeEventListener("mousedown",W),document.removeEventListener("keydown",G),k.removeEventListener("touchstart",_),k.removeEventListener("touchend",ee),k.removeEventListener("mouseup",$))},P=()=>{h=!1,j(),(()=>{for(let e=24;e>0;e--)if(A[e].innerHTML===A[e-1].innerHTML&&0!=A[e].innerHTML&&0!=A[e-1].innerHTML){let n=parseInt(A[e].innerHTML)+parseInt(A[e-1].innerHTML);A[e].innerHTML=n,A[e-1].innerHTML=0,m+=n,C.innerHTML=m,h=!0}K()})(),h&&V(),j(),N(),O()},Q=()=>{h=!1,z(),(()=>{for(let e=0;e<24;e++)if(A[e].innerHTML===A[e+1].innerHTML&&0!=A[e].innerHTML&&0!=A[e+1].innerHTML){let n=parseInt(A[e].innerHTML)+parseInt(A[e+1].innerHTML);A[e].innerHTML=n,A[e+1].innerHTML=0,m+=n,C.innerHTML=m,h=!0}K()})(),h&&V(),z(),N(),O()},R=()=>{h=!1,B(),(()=>{for(let e=24;e>4;e--)if(A[e].innerHTML===A[e-5].innerHTML&&0!=A[e].innerHTML&&0!=A[e-5].innerHTML){let n=parseInt(A[e].innerHTML)+parseInt(A[e-5].innerHTML);A[e].innerHTML=n,A[e-5].innerHTML=0,m+=n,C.innerHTML=m,h=!0}K()})(),h&&V(),B(),N(),O()},U=()=>{h=!1,F(),(()=>{for(let e=0;e<20;e++)if(A[e].innerHTML===A[e+5].innerHTML&&0!=A[e].innerHTML&&0!=A[e+5].innerHTML){let n=parseInt(A[e].innerHTML)+parseInt(A[e+5].innerHTML);A[e].innerHTML=n,A[e+5].innerHTML=0,m+=n,C.innerHTML=m,h=!0}K()})(),h&&V(),F(),N(),O()},W=e=>{y=e.pageX,g=e.pageY,1==e.which&&Z()},Z=()=>{k.addEventListener("mousemove",(e=>{e.preventDefault(),f=e.pageX,I=e.pageY}))},$=e=>{if(1==e.which){e.preventDefault();let n=f-y,t=I-g,r=Math.abs(n)>Math.abs(t),i=Math.abs(t)>Math.abs(n);n>0&&r?P():n<0&&r?Q():t>0&&i?R():t<0&&i&&U(),f=0,I=0,k.removeEventListener("mousemove",(e=>{e.preventDefault(),f=e.pageX,I=e.pageY}))}},_=e=>{e.cancelable&&(e.preventDefault(),E=e.touches[0].pageX,D=e.touches[0].pageY)},ee=e=>{if(e.cancelable){e.preventDefault();let n=e.changedTouches[0].pageX,t=e.changedTouches[0].pageY,r=n-E,i=t-D,a=Math.abs(r)>Math.abs(i),o=Math.abs(i)>Math.abs(r);r>0&&a?P():r<0&&a?Q():i>0&&o?R():i<0&&o&&U()}};w.addEventListener("click",X)})();
//# sourceMappingURL=main.bundle.js.map